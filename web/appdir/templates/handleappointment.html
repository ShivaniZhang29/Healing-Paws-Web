{% extends "base.html" %}

{% block content %}
<div>
    <div class="appointment"></div>
    <a href="{{ url_for('all_appointment') }}"><button>Back</button></a>
    <p>Appointment id: {{ appointment.id }}</p>
    <p>Appointment type:
        {% if appointment.is_emergency == true %}
            Emergency
        {% else %}
            Standard
        {% endif %}
    </p>
    <p>Submit time: {{ appointment.datetime }}</p>
    <p>Appointment Status: {{ appointment.status }}</p>
    <p>Appointment location:
        {% if  appointment.loc  == 1 %}
            Beijing
        {% elif  appointment.loc  == 2 %}
            Shanghai
        {% elif appointment.loc  == 3 %}
            Chengdu
        {% else %}
        {% endif %}
    </p>
    <p>Description: {{ appointment.description }}</p>
{#    <p>Appointment Date: {{ appointment.date }}</p>#}
{#    <p>Appointment Time: {{ appointment.time }}</p>#}
    <p>Customer Name: {{ customer.username }}</p>
    <p>Pet Name: {{ pet.name }}</p>
    <p>Preferred Doctor: {{ preferred.username }}</p>
    <p>Accept Adjustment:
        {% if  appointment.changeable == 1 %}
            Yes
        {% else %}
            No
        {% endif %}
    </p>
    <p>Assigned Employee:
        {% if assigned %}
             {{ assigned.username }}
        {% else %}
            None
        {% endif %}
    </p>
    {% if appointment.status == "Pending" %}
        <p>
            <a href="{{ url_for('update_appointment',apt=appointment.id,operation="Reject") }}"><button>Reject</button></a>
            <a href="{{ url_for('update_appointment',apt=appointment.id,operation="Confirm") }}"><button>Confirm</button></a>
        </p>
    {% elif appointment.status == "Confirmed" %}
        {% if appointment.is_emergency == true %}
            <p>
                Pet Status:
                <textarea id="pet_status",rows="1">{{ appointment.pet_status }}</textarea>
                <input id="update" type="button" value="update">
            </p>
        {% endif %}
        <p>
            <a href="{{ url_for('update_appointment',apt=appointment.id,operation="Cancel") }}"><button>Cancel</button></a>
            <a href="{{ url_for('update_appointment',apt=appointment.id,operation="Finish") }}"><button>Finish</button></a>
        </p>
    {% endif %}
</div>
<script>
    btn = document.getElementById('update');
    btn.onclick = function() {
            var pet_status = document.getElementById("pet_status").textContent.toString();
            alert(pet_status);
            window.location.href = "{{url_for('set_status',apt=appointment.id) }}&status="+pet_status;
        }
</script>
{% endblock %}
