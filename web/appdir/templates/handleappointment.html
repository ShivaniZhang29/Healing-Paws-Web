{% extends "base.html" %}

{% block content %}
<div class="big">
	<section class="banner-area relative" id="home">
		<div class="overlay overlay-bg"></div>	
		<div class="container">
			<div class="row fullscreen d-flex align-items-center justify-content-center">
				<div class="banner-content col-lg-8 col-md-12">
					<h1 class="i18n" name="welcome">	</h1>
					<p class="pt-10 pb-10 text-white i18n" name="hospital"></p>
				</div>										
			</div>
		</div>					
	</section>
    <a href={{ url_for('all_appointments',page=1) }}><button>Back</button></a>
    <hr>
	<section class="appointment-area">			
		<div class="container">
			<div class="row justify-content-between align-items-center pb-120 appointment-wrap">						
				<div class="col-lg-5 col-md-6 appointment-left">
					<ul class="time-list">
						<li class="d-flex justify-content-between i18n" name="apt_id">: {{ appointment.id }} </li>
						<li class="d-flex justify-content-between i18n" name="submit_time">: {{ appointment.datetime }}</li>
						<li class="d-flex justify-content-between">
                            <label class="i18n" name="apt_type"></label>
							{% if appointment.is_emergency == true %}
								<span class="red i18n" name="emergency"></span>
							{% else %}
								<b class="i18n" name="standard"></b>
							{% endif %}
						</li>
					</ul>
				</div>

    <div class="col-lg-6 col-md-6 appointment-right pt-80 pb-60">
    <table border="2px">
    <tr>
        <td class="i18n" name="apt_status"></td>
        <td>
        {% if appointment.status == 'Canceled' %}
            <b class="i18n" name="canceled"></b>
        {% elif appointment.status == 'Pending' %}
            <b class="i18n" name="pending"></b>
        {% elif appointment.status == 'Finished' %}
            <b class="i18n" name="finished"></b>
        {% elif appointment.status == 'Confirmed' %}
            <b class="i18n" name="confirmed"></b>
        {% endif %}
        </td>
    </tr>
    <tr>
        <td class="i18n" name="apt_location"></td>
        <td>
        {% if  appointment.loc  == 1 %}
            <b class="i18n" name="beijing"></b>
        {% elif  appointment.loc  == 2 %}
            <b class="i18n" name="shanghai"></b>
        {% elif appointment.loc  == 3 %}
            <b class="i18n" name="chengdu"></b>
        {% else %}
        {% endif %}
        </td>
    </tr>
    <tr>
        <td class="i18n" name="apt_desc"></td>
        <td><b>{{ appointment.description }}</td>
    </tr>
{#    <p>Appointment Date: <b>{{ appointment.date }}</b></p>#}
{#    <p>Appointment Time: <b>{{ appointment.time }}</b></p>#}
    <tr>
        <td class="i18n" name="customer_name"></td>
        <td><b>{{ customer.username }}</b></td>
    </tr>
    <tr>
        <td class="i18n" name="pet_name"></td>
        <td><b>{{ pet.name }}</b></td>
    </tr>
    <tr>
        <td class="i18n" name="prefer_doctor"></td>
        <td><b>{{ preferred.username }}</b>
    </td></tr>
    <tr><td class="i18n" name="accept_change"></td>
        <td>
            {% if appointment.changeable == 1 %}
                <b class="i18n" name="yes"></b>
            {% else %}
                <span class="red" class="i18n" name="no"></span>
            {% endif %}
        </td>
    </tr>
    <tr>
        <td class="i18n" name="assigned_employee"></td>
        {% if assigned %}
             <td><b>{{ assigned.username }}</b></td>
        {% else %}
            <td class="i18n" name="none"></td>
        {% endif %}
    </tr><br><br>
    </table>
    {% if appointment.status == "Pending" %}
        <p>
            <a href="{{ url_for('update_appointment',apt=appointment.id,operation='Reject') }}"><button class="i18n" name="reject"></button></a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <a href="{{ url_for('update_appointment',apt=appointment.id,operation='Confirm') }}"><button class="i18n" name="confirm"></button></a>
        </p>
    {% elif appointment.status == "Confirmed" %}
        {% if appointment.is_emergency == true %}
            <p>
                Pet Status:
                <textarea id="pet_status",rows="1">{{ appointment.pet_status }}</textarea>
                <input id="update" type="button" value="update">
            </p>
        {% endif %}
        <p>
            <a href="{{ url_for('update_appointment',apt=appointment.id,operation='Cancel') }}"><button class="i18n" name="cancel">Cancel</button></a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <a href="{{ url_for('update_appointment',apt=appointment.id,operation='Finish') }}"><button class="i18n" name="finish">Finish</button></a>
        </p>
    {% endif %}
    </div>
</div>
<script>
    btn = document.getElementById('update');
    btn.onclick = function() {
            let pet_status = document.getElementById("pet_status").value;
            alert(pet_status);
            window.location.href = "{{url_for('set_status',apt=appointment.id) }}&status="+pet_status;
        }

</script>
{% endblock %}
