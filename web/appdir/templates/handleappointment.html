{% extends "base.html" %}

{% block content %}
<div class="big">

    <a href="{{ url_for('all_appointment') }}"><button>Back</button></a><hr>
    <p>Appointment id: {{ appointment.id }} <span class="right"><i>Submit time: {{ appointment.datetime }}</i></span></p>
    <p>Appointment type:
        {% if appointment.is_emergency == true %}
            <span class="red">Emergency</span>
        {% else %}
            <b>Standard</b>
        {% endif %}
    </p><hr>
    
    <p>Appointment Status: <b>{{ appointment.status }}</p></b>
    <p>Appointment location:
        {% if  appointment.loc  == 1 %}
            <b>Beijing</b>
        {% elif  appointment.loc  == 2 %}
            <b>Shanghai</b>
        {% elif appointment.loc  == 3 %}
            <b>Chengdu</b>
        {% else %}
        {% endif %}
    </p>
    <p>Description: <b>{{ appointment.description }}</b></p>
{#    <p>Appointment Date: <b>{{ appointment.date }}</b></p>#}
{#    <p>Appointment Time: <b>{{ appointment.time }}</b></p>#}
    <p>Customer Name: <b>{{ customer.username }}</b></p>
    <p>Pet Name: <b>{{ pet.name }}</b></p>
    <p>Preferred Doctor: <b>{{ preferred.username }}</b></p>
    <p>Accept Adjustment:
        {% if  appointment.changeable == 1 %}
            <b>Yes</b>
        {% else %}
            <span class="red">No</span>
        {% endif %}
    </p>
    <p>Assigned Employee:
        {% if assigned %}
             <b>{{ assigned.username }}</b>
        {% else %}
            None
        {% endif %}
    </p>
    {% if appointment.status == "Pending" %}
        <p>
            <a href="{{ url_for('update_appointment',apt=appointment.id,operation='Reject') }}"><button>Reject</button></a>
            <a href="{{ url_for('update_appointment',apt=appointment.id,operation='Confirm') }}"><button>Confirm</button></a>
        </p>
    {% elif appointment.status == "Confirmed" %}
        {% if appointment.is_emergency == true %}
            <p>
                Pet Status:
                <textarea id="pet_status",rows="1">{{ appointment.pet_status }}</textarea>
                <input id="update" type="button" value="update">
            </p>
        {% endif %}
        <p>
            <a href="{{ url_for('update_appointment',apt=appointment.id,operation='Cancel') }}"><button>Cancel</button></a>
            <a href="{{ url_for('update_appointment',apt=appointment.id,operation='Finish') }}"><button>Finish</button></a>
        </p>
    {% endif %}
</div>
<script>
    btn = document.getElementById('update');
    btn.onclick = function() {
            var pet_status = document.getElementById("pet_status").textContent.toString();
            alert(pet_status);
            window.location.href = "{{url_for('set_status',apt=appointment.id) }}&status="+pet_status;
        }
</script>
{% endblock %}
